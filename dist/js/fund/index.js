Helper.getRem("30","750"),$(function(){Helper.setCookie("ques","off",token_exp,"/");var a=new fundCore({getQuery:!0}),t=function(){this.$upbord=$(".js-bord_ctn"),this.$upconcept=$(".js-index_ctn"),this.$dc=$(document),this.getBanner=function(){a.Ajax(a.fundurl.banner,"GET",null,function(a){var t=a.message.result;$(".fundindex_bannerbd ul").empty();for(var n=0;n<t.length;n++)$('<li><a href="'+t[n].href+'">                             <img _src="'+t[n].url+'" src="static/fund/images/blank.png" />                             </a></li>').appendTo(".fundindex_bannerbd ul");var e={slideCell:"#focus",titCell:".fundindex_bannerhd ul",mainCell:".fundindex_bannerbd ul",effect:"leftLoop",autoPlay:!0,autoPage:!0,switchLoad:"_src"};$.extend(e,{autoPlay:t.length>1}),TouchSlide(e)},!1)},this.weekly=function(){var t=this;a.Ajax(a.fundurl.weekly,"GET",{type:1,offset:0,limit:3},function(a){t.$dc.trigger("addData",{data:a.message.result,el:t.$upconcept,tp:1})},!1),a.Ajax(a.fundurl.weekly,"GET",{type:0,offset:0,limit:3},function(a){t.$dc.trigger("addData",{data:a.message.result,el:t.$upbord,tp:0})},!1)},this.getNews=function(){var t=this;a.Ajax(a.fundurl.newsfetch,"GET",{offset:0,limit:4},function(a){t.$dc.trigger("addNews",{data:a.message})},!1)},this.getChg=function(a){try{return a=parseFloat(a),a>=0?[a+"%","_up"]:a<0?[a+"%","_down"]:["--",null]}catch(t){return console.log(t),["--",null]}},this.filterChg=function(a){var t={value:"",percent:"",color:"","class":""};return a=parseFloat(a).toFixed(2),a>0?(t.value="+"+a+"%",t.color="#f24957",t["class"]="_up",a>=10?t.percent=100:t.percent=1*parseFloat(a/10*100).toFixed(2)):a<0?(t.value=a+"%",t.color="#1fbf62",t["class"]="_down",a<=-10?t.percent=100:t.percent=1*-parseFloat(a/10*100).toFixed(2)):(t.percent=1*a,t["class"]="_none",t.value=a+"%",t.color="#b2b2c5"),t},this.getRealindex=function(t){var n=$(".js-fundindex_indexdata");a.Ajax(a.fundurl.realtime,"GET",null,function(a){a.message.map(function(a,t){var e=(a.inc>0?"+":"")+a.inc+"&nbsp"+(a.inc>0?"+":"")+a.chg+"%";n.find(".js-index_num").eq(t).text(a.index).addClass(a.inc>0?"_up":"_down"),n.find(".js-index_state").eq(t).html(e).addClass(a.inc>0?"_up":"_down")})},!1,!1,!1)},this.getRecommend=function(){var t=this;a.Ajax(a.fundurl.recoms,"GET",null,function(a){var n=a.message.result.recoms;$(".fundindex_list").empty();var e,d=$('<div class="fnlist_hidden"></div>'),i=[],s=[];if(e=0==moment(new Date).diff(moment(n[0].dt),"days")?"今日推荐":"",e?$('<div class="fundindex_listtitle"><span>'+e+"</span>&nbsp;&nbsp;"+moment(n[0].dt).format("M月D日")+"</div>").appendTo(".fundindex_tag"):$('<div class="fundindex_listtitle">'+e+"&nbsp;&nbsp;"+moment(n[0].dt).format("M月D日")+"</div>").appendTo(".fundindex_tag"),n.map(function(a,n){var e=t.filterChg(a.chg);a.Fcode=a.fcode.split("_")[0],"股价"===a.cat?a.type="price":"新闻"===a.cat?a.type="news":"指标"===a.cat&&(a.type="index"),n>=4?(s[n]=$('<div class="fundindex_data" >                             <div class="data_forward"><div class="data_forward_up"><span class="data_fname">'+a.fname+'</span>                             <span class="data_invtyp">'+a.invtyp+'</span><span class="data_fcode">'+a.Fcode+'</span></div><div class="data_forward_down">                             <span class="data_cat">'+a.cat+"</span>"+(null!=a.posi?'<span class="'+("利好"==a.posi?"data_situp":"data_sitdown")+'">'+a.posi+"</span>":"")+'<span class="data_t">'+a.t+'</span></div></div>                             <div class="data_backward"><div class="overlay"><div class="data_up">日涨幅</div><div class="data_num '+e["class"]+' num_en">'+e.value+"</div></div></div>                         </div>"),s[n].find(".data_backward").css("background-image",drawSpie(e.percent,e.color,"#dddde6")),s[n].on("click",{type:a.type,code:a.fcode,dt:a.dt},function(a){jumptopage("static/fund/fundsuportdetail.html?type="+a.data.type+"&from="+_from+"&fcode="+a.data.code+"&dt="+a.data.dt)})):(i[n]=$('<div class="fundindex_data" >                             <div class="data_forward"><div class="data_forward_up"><span class="data_fname">'+a.fname+'</span>                             <span class="data_invtyp">'+a.invtyp+'</span><span class="data_fcode">'+a.Fcode+'</span></div><div class="data_forward_down">                             <span class="data_cat">'+a.cat+"</span>"+(null!=a.posi?'<span class="'+("利好"==a.posi?"data_situp":"data_sitdown")+'">'+a.posi+"</span>":"")+'<span class="data_t">'+a.t+'</span></div></div>                             <div class="data_backward"><div class="overlay"><div class="data_up">日涨幅</div><div class="data_num '+e["class"]+' num_en">'+e.value+"</div></div></div>                         </div>"),i[n].find(".data_backward").css("background-image",drawSpie(e.percent,e.color,"#dddde6")),i[n].on("click",{type:a.type,code:a.fcode,dt:a.dt},function(a){jumptopage("static/fund/fundsuportdetail.html?type="+a.data.type+"&from="+_from+"&fcode="+a.data.code+"&dt="+a.data.dt)}))}),d.append(s),i.push(d),n.length>4){var c=$('<div class="fundindex_more">查看更多</div>');c.on("click",function(){var a=this;d.slideToggle("400",function(){"查看更多"===$(a).html()?$(a).html("收起"):$(a).html("查看更多")})}),i.push(c)}$(".fundindex_list").append(i)}.bind(this),!1)},this.bindEvent=function(){var a=this;this.$dc.on("addData",function(t,n){var e=n.data,d=[],i=n.el,s=e.fund.length-1,c=n.tp;c?(i.siblings(".bordtitle_y").find(".js-bordname").text(e.name),i.siblings(".bordtitle_y").find(".js-bord_num").text(null==e.chg?"--":a.filterChg(e.chg).value),i.siblings(".bordtitle_y").on("click",function(a){jumptopage("/static/fund/fundtype.html?mdcode="+e.code+"&md=concept")}),i.siblings(".fundindex_title").on("click",function(a){jumptopage("static/fund/fundledcapte.html?type="+$(this).data("type")+"&from="+_from)})):(i.siblings(".bordtitle").find(".js-bordname").text(e.name),i.siblings(".bordtitle").find(".js-bord_num").text(null==e.chg?"--":a.filterChg(e.chg).value),i.siblings(".bordtitle").on("click",function(a){jumptopage("/static/fund/fundtype.html?mdcode="+e.code+"&md=module")}),i.siblings(".fundindex_title").on("click",function(a){jumptopage("static/fund/fundledmodule.html?type="+$(this).data("type")+"&from="+_from)})),e.fund.map(function(t,n){chg=a.filterChg(t.chg),t.code=t.fcode.split("_")[0],iblock=n===s?'<i class="bdicon_last"></i>':"",d[n]=$('<li class="bord_data"><i class="'+(c?"index_icon":"bord_icon")+'">'+iblock+'</i><div class="bord_dt"><div><span class="bd_dtname">'+t.name+'</span></br><span class="bd_dtcode">'+t.code+'</span></div><span class="bd_dtpercent '+chg["class"]+'">'+chg.value+"</span></div></li>"),d[n].on("click",{code:t.fcode},function(a){"货币型"===t.invtyp||"理财型"===t.invtyp?jumptopage("/static/fund/fund_details.html?fcode="+a.data.code):jumptopage("/static/fund/funddetail.html?fcode="+a.data.code)})}),i.empty().append(d)}),this.$dc.on("addNews",function(a,t){var n=t.data.result,e=[],d=$(".js-info_ctn");d.siblings(".fundindex_title").on("click",function(){jumptopage("static/info/index.html?from="+_from)}),n.map(function(a,t){var n=moment(a.dt).format("MM-DD HH:mm");e[t]=$('<li class="info_data"><span class="info_title">'+a.title+'</span><span class="info_dt">'+n+"</span></li>"),e[t].on("click",{id:a.id},function(a){jumptopage("/static/info/infodetail.html?id="+a.data.id+"&from="+_from)})}),d.empty().append(e)}),this.$dc.delegate(".js-lead","click",function(a){jumptopage("static/fund/fundledmodule.html?type="+$(this).data("type")+"&from="+_from)}).delegate(".js-concept","click",function(a){jumptopage("static/fund/fundledcapte.html?type="+$(this).data("type")+"&from="+_from)}),$(".fund_fund").on("click",function(){jumptopage("static/fund/chosefund.html?from="+_from)}),$(".fund_devers").on("click",function(){jumptopage("view/fund/fundvaluation.html?from="+_from+"&type=estimate")}),$(".fund_rank").on("click",function(){jumptopage("../view/fund/rankinglist.html?from="+_from+"&type=rankings")}),$(".fund_company").on("click",function(){jumptopage("../view/company/index.html?from="+_from+"&type=rankings")}),$(".js-manager_more").on("click",function(){jumptopage("../view/company/manager_ranking.html?from="+_from)}),$(".fundidnex_search").on("click",function(){jumptopage("../view/search/index.html?uid="+uid+"&userid="+userid+"&from="+_from)})},this.slider=function(t){var n=this;a.Ajax(a.fundurl.manager,"GET",null,function(a){var t=[];a.message.result.map(function(a,e){var d=n.filterChg(a.chg);t.push({content:function(t){var n=(document.createDocumentFragment(),$('<div class="fundmanager_card"><div class="mag_head"></div><span class="mag_name">'+a.name+'</span>                             <span class="mag_cmp">'+a.org+'</span>                             <div class="mag_star js-mag_star"></div>                             <span class="mag_fullcmp">'+a.fname+'</span>                             <span class="mag_back">任期回报</span>                             <span class="mag_percent '+d["class"]+'">'+d.value+"</span>                             </div>"));a.grade=parseInt(a.grade);for(var e=[],i=0;i<a.grade;i++)e[i]='<i class="stars"></i>';return n.find(".js-mag_star").append(e),n.on("click",{pid:a.pid},function(a){a.stopPropagation(),jumptopage("/static/company/man_details.html?pid="+a.data.pid+"&from="+_from)}),n[0]}(e)})});new iSlider(document.getElementById("slider"),t,{isLooping:1,isOverspread:1,isAutoplay:1,duration:2e3,isTouchable:!0,animateTime:500,fillSeam:1,fixPage:0,animateType:"depth"})},!1)},this.init=function(){this.bindEvent(),this.getBanner(),this.getRecommend(),this.getRealindex(),this.weekly(),this.getNews(),$("body").fadeIn(),this.slider()},this.init()};new t});
//# sourceMappingURL=index.js.map
